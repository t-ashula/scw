#!/usr/bin/env node

var WMapper = require(__dirname + '/../src/wmapper'),
  program = require('commander'),
  fs = require('fs'),
  wmapper = new WMapper(),
  url, res;

program
  .version(JSON.parse(fs.readFileSync(__dirname + '/../package.json', 'utf8')).version)
  .usage('[options] <url>')
  .option('-a, --agent <agent>', 'set user agent string')
  .option('--verbose', 'verbose output')
  .parse(process.argv);

program.name = 'wmapper';

if (program.args.length !== 1) {
  program.help();
}

url = program.args[0];

if (program.agent) {
  console.log(program.agent);
  wmapper.userAgent(program.agent);
}

if (program.verbose) {
  wmapper.loglevel('verbose');
}

wmapper.run(url);
